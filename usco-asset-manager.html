<link rel="import" href="../polymer/polymer.html"> 

<link rel="import" href="usco-store-base.html"> 
<link rel="import" href="usco-parser-base.html"> 
<link rel="import" href="usco-serializer-base.html"> 

<script src="lib/asset-manager.js"></script>

<polymer-element name="usco-asset-manager">
  <template>
  </template>
  <script>Polymer('usco-asset-manager',{
      storesTimeout:0,
      created:function()
      {
        var AssetManager = require("asset-manager");
        this.assetManager = new AssetManager();
      },
      ready: function() {
      },
      enteredView:function()
      {
      },
      leftView:function()
      {
        this.assetManager = null;
      },
      //public api
      addStore:function( storeElement )
      {
        console.log("adding store", storeElement.localName);
        this.assetManager.addStore( this._getExtension( storeElement ), storeElement.store );
      },
      addParser:function( parserElement )
      {
        console.log("adding parser", parserElement.localName);
        this.assetManager.addParser( this._getExtension( parserElement ), parserElement.parser );
      },
      addSerializer:function( serializerElement )
      {
        console.log("adding serializer", serializerElement.localName);
        this.assetManager.addSerializer( this._getExtension( serializerElement ), serializerElement.serializer );
      },
      removeStore: function( storeElement )
      {
        this.assetManager.removeStore( this._getExtension( storeElement ), storeElement.store );
      },
      removeParser: function( parser )
      {
        this.assetManager.removeParser( this._getExtension( parserElement ), parserElement.parser );
      },
      removeSerializer: function( serializer )
      {
        this.assetManager.removeSerializer( this._getExtension( serializerElement ), serializerElement.serializer );
      },
      loadResource:function( uri, options )
      {
        return this.assetManager.load( uri , options )
      },
      //helpers
      _getExtension:function( element )
      {
        var extension = element.localName.split("-").shift();
        return extension;
      }
    });
  </script>
</polymer-element>
